---
interface Props {
  embedUrl: string;
  title: string;
}

const { embedUrl, title } = Astro.props;
---

<div>
  <h2 class="font-semibold text-neutral-900 mb-4 flex items-center gap-2">
    <svg class="w-5 h-5 text-neutral-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
    </svg>
    Embed This Calculator
  </h2>
  <p class="text-sm text-neutral-500 mb-4">
    Copy the code below to embed this calculator on your website.
  </p>

  <div class="relative">
    <pre
      id="embed-code"
      class="bg-neutral-900 text-neutral-300 text-xs p-4 rounded-xl overflow-x-auto font-mono"
    ><code class="text-primary-400">&lt;iframe</code>
  <code class="text-neutral-500">src=</code><code class="text-sidehustle-400">"{embedUrl}"</code>
  <code class="text-neutral-500">width=</code><code class="text-sidehustle-400">"100%"</code>
  <code class="text-neutral-500">height=</code><code class="text-sidehustle-400">"500"</code>
  <code class="text-neutral-500">frameborder=</code><code class="text-sidehustle-400">"0"</code>
  <code class="text-neutral-500">title=</code><code class="text-sidehustle-400">"{title}"</code>
<code class="text-primary-400">&gt;&lt;/iframe&gt;</code></pre>

    <button
      id="copy-embed-btn"
      class="absolute top-3 right-3 px-3 py-1.5 bg-primary-500 hover:bg-primary-600 text-white text-xs font-semibold rounded-lg transition-colors shadow-lg shadow-primary-500/25"
    >
      Copy
    </button>
  </div>
</div>

<script>
  const btn = document.getElementById('copy-embed-btn');
  const code = document.getElementById('embed-code');

  btn?.addEventListener('click', async () => {
    const text = code?.textContent || '';
    try {
      await navigator.clipboard.writeText(text);
      if (btn) {
        btn.textContent = 'Copied!';
        setTimeout(() => {
          btn.textContent = 'Copy';
        }, 2000);
      }
    } catch {
      console.error('Failed to copy');
    }
  });
</script>
